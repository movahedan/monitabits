---
description: How to discover and identify documentation files that need updates based on code changes, understand documentation structure and relationships
globs: ["**/*.md", "**/*.mdc", "**/CLAUDE.md", "**/README.md", "**/*.json"]
alwaysApply: true
---

# Documentation

## Four-Tier Documentation Structure

1. **`.cursor/rules/`** - Code standards, patterns, workflows (AI-focused)
2. **`CLAUDE.md`** - Project context, commands, architecture (AI-focused)
3. **`README.md`** - Project description, architecture ideas, development tips (Human-focused)
4. **`docs/`** - Developer guides, setup, technical details (Human-focused)

## Documentation Relationships

### Connection Graph
```
README.md ──────┐
                ├─→ Complementary pair (different audiences, same project)
CLAUDE.md ──────┘
      │
      ├─→ References → .cursor/rules/ (for standards)
      │
      └─→ Points to → docs/ (for detailed guides)

.cursor/rules/ ──→ AI uses → CLAUDE.md (for project context)

docs/ ──→ Human reads → README.md (for overview)
```

### README.md ↔ CLAUDE.md Relationship

**README.md and CLAUDE.md are complementary and should be kept in sync:**
- **README.md**: Human-first overview, describes what the project is, architectural ideas, development mindset
- **CLAUDE.md**: AI-first context, detailed commands, package structure, how to work in the project
- Both cover the same project but from different angles
- README is marketing/onboarding for humans
- CLAUDE is technical/operational for AI tools
- When architecture changes, update both
- README has "tips" → CLAUDE has "detailed usage"

## Best Practices by Document Type

### .cursor/rules/ (AI-Focused Rules)
```markdown
# Code-first, compact, scannable
- Focus on patterns, not explanations
- Show ✅ good vs ❌ bad code examples
- Keep under 500 lines per rule
- Use globs/alwaysApply metadata correctly
- Reference files with @filename when needed
- Remove explanations, trust linter
```

### CLAUDE.md (AI-Focused Context)
```markdown
# Project context and commands
- List essential commands with examples
- Document package/app structure
- Reference .cursor/rules/ for standards
- Include key files and their purposes
- Document project-specific workflows
- Keep commands grouped by purpose
- Link to nested CLAUDE.md files in packages/apps
- Sync commands with package.json scripts
```

### README.md (Human-Focused Overview)
```markdown
# Project description and architecture
- What the project is and why it exists
- Architectural ideas and design decisions
- Development mindset and philosophy
- Quick start tips (detailed usage in CLAUDE.md)
- Visual badges and emojis for scannability
- High-level overview, not implementation details
- Keep in sync with CLAUDE.md for same project context
```

### docs/ (Human-Focused Guides)
```markdown
# Brief, summarized developer guides (NOT exhaustive)
- Friendly, enjoyable to read
- Examples that actually work
- Table of contents with anchor links
- Numbered prefixes for ordered docs (1_INSTALLATION.md)
- Troubleshooting guides (concise)
- Technical summaries (not deep-dives)
- Workflow overviews (brief)
- Keep it summarized - developers want quick answers, not novels
```

## Syncing with package.json and tsconfig.json

**Keep documentation in sync with package.json and tsconfig.json:**

### package.json
- **Scripts**: Sync CLAUDE.md commands with `package.json` scripts
- **Dependencies**: Reference actual dependencies from `package.json`
- **When scripts change**: Update CLAUDE.md and docs/ to match
- **Verification**: Check `package.json` when documenting commands

### tsconfig.json
- **Package relationships**: Understand relationships through `tsconfig.json` references
- **Module resolution**: Document import paths based on actual tsconfig settings
- **Cross-package dependencies**: Use tsconfig to trace how packages relate

### Documentation Sync Principles
1. Check `package.json` when documenting commands or scripts
2. Check `tsconfig.json` to understand package relationships
3. Keep docs in sync - update when these files change
4. Documentation should reflect actual configuration

## When to Update What

- **`.cursor/rules/`**: Code standards, patterns, workflows change
- **`CLAUDE.md`**: Project structure, commands, scripts, package/app context change
- **`README.md`**: Architecture changes, project description, development philosophy change
- **`docs/`**: Workflows, processes, setup instructions, technical details change

**Important**: When architecture/project structure changes, update both README.md AND CLAUDE.md

## Discovery Process

When code changes are made, discover related documentation:

### 1. Search by Keywords from Changes
```bash
# Extract key terms from changed files
grep -r "keyword" docs/
grep -r "keyword" **/CLAUDE.md
grep -r "keyword" **/README.md
grep -r "keyword" .cursor/rules/

# Search git history for recent doc changes
git log --oneline -- docs/ | grep -i "keyword"
git log --oneline -- README.md CLAUDE.md
```

### 2. Search by File/Path Patterns
```bash
# If code in apps/monitabits-api changed
grep -r "monitabits-api\|API\|api" docs/
grep -r "monitabits-api" **/CLAUDE.md **/README.md

# If code in packages/ui changed
grep -r "ui\|component\|UI" docs/
grep -r "ui" **/README.md **/CLAUDE.md

# If docker-compose or Dockerfile changed
grep -r "docker\|Docker\|container" docs/
```

### 3. Search by Commands/Scripts
```bash
# If package.json scripts changed
grep -r "bun run\|npm run\|script" docs/
grep -r "bun run" CLAUDE.md README.md

# If CI/CD files changed
grep -r "github\|actions\|CI\|deploy" docs/
```

### 4. Search by Technology/Framework
```bash
# If React code changed
grep -r "react\|React\|component\|frontend" docs/ README.md

# If NestJS code changed
grep -r "nestjs\|NestJS\|backend\|API" docs/ README.md

# If database code changed
grep -r "database\|db\|prisma\|PostgreSQL" docs/
```

### 5. Recent Changes Context
```bash
# Check what docs were recently updated
git log --oneline --since="2 weeks ago" -- docs/ README.md CLAUDE.md

# Check what code files changed alongside docs
git log --name-only -- docs/ README.md | grep -E "\.(ts|tsx|js|jsx)$"

# Find docs that mention files you're changing
grep -r "apps/monitabits-api\|packages/ui" docs/ README.md CLAUDE.md
```

### 6. Cross-Reference Search
```bash
# Find docs that reference each other
grep -r "3_DEV_FLOWS\|2_SETUP_FLOWS\|5_DOCKER" docs/
grep -r "CLAUDE.md\|README.md" docs/

# Find README.md and CLAUDE.md files
find . -name "README.md" -o -name "CLAUDE.md"
```

## Quick Reference Commands
```bash
# List all docs
find docs/ -name "*.md" -type f
find . -name "README.md" -type f
find . -name "CLAUDE.md" -type f
find .cursor/rules -name "*.mdc" -type f

# Search across all doc types
grep -r "keyword" docs/ .cursor/rules/ --include="*.md" --include="*.mdc"
grep -r "keyword" **/README.md **/CLAUDE.md

# Check git history
git log --oneline -- docs/ README.md CLAUDE.md
git log --oneline -- .cursor/rules/
```

## Update Process

1. Use discovery methods above to find related docs
2. Check `package.json` scripts and `tsconfig.json` relationships
3. Check README.md and CLAUDE.md together (they're complementary)
4. Read found docs to understand current state
5. Sync documentation with `package.json` scripts and `tsconfig.json`
6. Update docs to reflect changes (remove outdated info)
7. Verify examples still work
8. Cross-reference related docs for consistency