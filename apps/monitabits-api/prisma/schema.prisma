generator client {
	provider   = "prisma-client-js"
	output     = "../../../node_modules/.prisma/client"
	engineType = "library"
}

datasource db {
	provider = "postgresql"
}

model Device {
	id        String    @id @default(uuid())
	createdAt DateTime  @default(now())
	updatedAt DateTime  @updatedAt

	timer     Timer?
	settings  Settings?
	sessions  PomodoroSession[]

	@@map("devices")
}

model Timer {
	id              String   @id @default(uuid())
	deviceId        String   @unique
	status          String   // "idle" | "running" | "paused" | "completed"
	type            String   // "work" | "short_break" | "long_break"
	durationSeconds Int      // Total duration in seconds
	remainingSeconds Int     // Remaining time in seconds
	startedAt       DateTime?
	pausedAt        DateTime?
	createdAt       DateTime @default(now())
	updatedAt       DateTime @updatedAt

	device          Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade)

	@@index([deviceId])
	@@map("timers")
}

model Settings {
	id              String   @id @default(uuid())
	deviceId        String   @unique
	workMinutes     Int      @default(25)
	shortBreakMinutes Int    @default(5)
	longBreakMinutes Int     @default(15)
	updatedAt       DateTime @updatedAt

	device          Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade)

	@@map("settings")
}

model PomodoroSession {
	id              String   @id @default(uuid())
	deviceId        String
	type            String   // "work" | "short_break" | "long_break"
	durationSeconds Int      // Actual duration completed
	completedAt     DateTime @default(now())
	createdAt       DateTime @default(now())

	device          Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade)

	@@index([deviceId])
	@@index([deviceId, completedAt])
	@@map("pomodoro_sessions")
}
